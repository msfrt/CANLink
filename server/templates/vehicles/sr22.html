<!DOCTYPE html>
<html>
  <head>
    <title>SR-22 CANLink</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
    <!-- JQuery-->
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>

    <!-- SocketIO JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
    


    <style type="text/css">

      /* inline CSS is generally considered a bad practice!!! Don't do this in your job! */

      .container {
        max-width: 500px;
        padding-top: 100px;
      }

      main, body {

        align-items: center;
        padding-top: 40px;
        padding-bottom: 40px;
        background-color: #f5f5f5;

      }

      main {
        width: 100%;
        max-width: 1000px;
        padding: 15px;
        margin: auto;
      }
    </style>
  </head>
  <body>
    <main>

      <div class="row">
        <img class="mb-4" src="static/img/SR_Badge.svg" alt="" width="72" height="73">
      </div>
      
      <div class="row text-center">
        <h1 class="h3 mb-1 fw-normal">SR-22 CANLink</h1>
      </div>

      <div class="row text-center">
        <p><a href="/">Back to vehicles.</a></p>
      </div>

      <!-- data manipulations below -->
      <div class="row">

        <!-- left column -->
        <div class="col-md-6 col-sm-12">
          
          <!-- data pod 1 below -->
          <div class="p-4 bg-light border rounded-3">
            <h2 class="h4 mb-1">Driver Signals</h2>
            <p>Communicate with the driver via the driver display</p>
            
            <div class="">
              <h3 class="h5 mb-1">Display Message</h3>
            </div>

            <!-- message input characters -->
            <div class="row gx-1 align-items-center">
              <div class="col-auto">
                <input id="driverMessage1" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input id="driverMessage2" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input id="driverMessage3" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input id="driverMessage4" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input id="driverMessage5" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input id="driverMessage6" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input id="driverMessage7" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input id="driverMessage8" class="text-center form-control px-1" maxlength="1"  style="max-width: 2em;">
              </div>
              <div class="col-auto">
                <input type="submit" id="driverMessageSend" class="btn btn-primary form-control"></button>
              </div>
            </div> <!-- end message input characters -->
            

            <div class="">
              <h3 class="h5 mb-1">Flash LEDs</h3>
            </div>

          </div> <!-- end data pod 1 -->

        </div>  <!-- end left column -->

        <!-- right column -->
        <div class="col-md-6 col-sm-12">
          <h2>right</h2>
        </div>  <!-- end right column -->

      </div> <!--end data manipulations-->
  
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script> 
  
    <!-- again, bad practice to keep JS in the HTML file however, here we are... -->
    <!-- This script uses JQuery to automatically move to the next driver input message box -->
    <script>
      $(function() {
        for (let i = 1; i < 9; i++){
          $('#driverMessage' + i).keypress(function() {
            var self = $(this);
            //wait until character is inserted
            setTimeout(function() {
              if (self.val().length > 0) {
                $('#driverMessage' + (i+1)).focus();  // moves the cursor
                $('#driverMessage' + (i+1)).val('');  // clears the old input

                // if at the last input, move to the button
                if (i == 8){
                  $('#driverMessageSend').focus();  // moves the cursor
                }
              }
            }, 1);
          });
        }
      });
      </script>


      <!-- This section will implement all of the SocketIO stuff -->
      <script>


        // this is called a closure. We define an entire funciton *within* another
        // call to a different function. 
        $(document).ready(function(){
          var socket = io();

          socket.on('connect', function() {
              socket.emit('sr22_connected', {data: 'I\'m connected!'});
          });

          // // install a listener for when the message button is pressed
          // $('#driverMessageSend').on('submit', function(event){
          //   event.preventDefault();  // prevents the page from reloading
          // });

          // // revieve a broadcast message from the server
          // socket.on('after connect', function(msg){
          //   console.log('After connect', msg);
          // });


        }); // end (document).ready

      // </script>
  
  </body>
</html>